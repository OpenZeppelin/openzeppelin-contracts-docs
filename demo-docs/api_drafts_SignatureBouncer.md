---
id: drafts_SignatureBouncer
title: SignatureBouncer
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> SignatureBouncer</h2><p class="base-contracts"><span>is</span> <a href="access_roles_SignerRole.html">SignerRole</a></p><p class="description">SignatureBouncer allows users to submit a signature as a permission to do an action. If the signature is from one of the authorized signer addresses, the signature is valid. Note that SignatureBouncer offers no protection against replay attacks, users must add this themselves! * Signer addresses can be individual servers signing grants or different users within a decentralized club that have permission to invite other members. This technique is useful for whitelists and airdrops; instead of putting all valid addresses on-chain, simply sign a grant of the form keccak256(abi.encodePacked(`:contractAddress` + `:granteeAddress`)) using a valid signer address. Then restrict access to your crowdsale/whitelist/airdrop using the `onlyValidSignature` modifier (or implement your own using _isValidSignature). In addition to `onlyValidSignature`, `onlyValidSignatureAndMethod` and `onlyValidSignatureAndData` can be used to restrict access to only a given method or a given method with given parameters respectively. See the tests in SignatureBouncer.test.js for specific usage examples. * @notice A method that uses the `onlyValidSignatureAndData` modifier must make the _signature parameter the &quot;last&quot; parameter. You cannot sign a message that has its own signature in it so the last 128 bytes of msg.data (which represents the length of the _signature data and the _signaature data itself) is ignored when validating. Also non fixed sized parameters make constructing the data in the signature much more complex. See https://ethereum.stackexchange.com/a/50616 for more details.</p><div class="source">Source: <a href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/v2.1.2/contracts/drafts/SignatureBouncer.sol" target="_blank">drafts/SignatureBouncer.sol</a></div><div class="author">Author: PhABC, Shrugs and aflesher</div></div><div class="index"><h2>Index</h2><ul><li><a href="drafts_SignatureBouncer.html#_isValidDataHash">_isValidDataHash</a></li><li><a href="drafts_SignatureBouncer.html#_isValidSignature">_isValidSignature</a></li><li><a href="drafts_SignatureBouncer.html#_isValidSignatureAndData">_isValidSignatureAndData</a></li><li><a href="drafts_SignatureBouncer.html#_isValidSignatureAndMethod">_isValidSignatureAndMethod</a></li><li><a href="drafts_SignatureBouncer.html#">fallback</a></li><li><a href="drafts_SignatureBouncer.html#onlyValidSignature">onlyValidSignature</a></li><li><a href="drafts_SignatureBouncer.html#onlyValidSignatureAndData">onlyValidSignatureAndData</a></li><li><a href="drafts_SignatureBouncer.html#onlyValidSignatureAndMethod">onlyValidSignatureAndMethod</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="modifiers"><h3>Modifiers</h3><ul><li><div class="item modifier"><span id="onlyValidSignature" class="anchor-marker"></span><h4 class="name">onlyValidSignature</h4><div class="body"><code class="signature">modifier <strong>onlyValidSignature</strong><span>(bytes signature) </span></code><hr/><div class="description"><p>Requires that a valid signature of a signer was provided.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>signature</code> - bytes</div></dd></dl></div></div></li><li><div class="item modifier"><span id="onlyValidSignatureAndData" class="anchor-marker"></span><h4 class="name">onlyValidSignatureAndData</h4><div class="body"><code class="signature">modifier <strong>onlyValidSignatureAndData</strong><span>(bytes signature) </span></code><hr/><div class="description"><p>Requires that a valid signature with a specifed method and params of a signer was provided.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>signature</code> - bytes</div></dd></dl></div></div></li><li><div class="item modifier"><span id="onlyValidSignatureAndMethod" class="anchor-marker"></span><h4 class="name">onlyValidSignatureAndMethod</h4><div class="body"><code class="signature">modifier <strong>onlyValidSignatureAndMethod</strong><span>(bytes signature) </span></code><hr/><div class="description"><p>Requires that a valid signature with a specifed method of a signer was provided.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>signature</code> - bytes</div></dd></dl></div></div></li></ul></div><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="_isValidDataHash" class="anchor-marker"></span><h4 class="name">_isValidDataHash</h4><div class="body"><code class="signature">function <strong>_isValidDataHash</strong><span>(bytes32 hash, bytes signature) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Internal function to convert a hash to an eth signed message and then recover the signature and check it against the signer role.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>hash</code> - bytes32</div><div><code>signature</code> - bytes</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="_isValidSignature" class="anchor-marker"></span><h4 class="name">_isValidSignature</h4><div class="body"><code class="signature">function <strong>_isValidSignature</strong><span>(address account, bytes signature) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Is the signature of `this + sender` from a signer?.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>account</code> - address</div><div><code>signature</code> - bytes</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="_isValidSignatureAndData" class="anchor-marker"></span><h4 class="name">_isValidSignatureAndData</h4><div class="body"><code class="signature">function <strong>_isValidSignatureAndData</strong><span>(address account, bytes signature) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Is the signature of `this + sender + methodId + params(s)` from a signer?, the signature parameter of the method being validated must be the &quot;last&quot; parameter.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>account</code> - address</div><div><code>signature</code> - bytes</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="_isValidSignatureAndMethod" class="anchor-marker"></span><h4 class="name">_isValidSignatureAndMethod</h4><div class="body"><code class="signature">function <strong>_isValidSignatureAndMethod</strong><span>(address account, bytes signature) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><div class="description"><p>Is the signature of `this + sender + methodId` from a signer?.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>account</code> - address</div><div><code>signature</code> - bytes</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="fallback" class="anchor-marker"></span><h4 class="name">fallback</h4><div class="body"><code class="signature">function <strong></strong><span>() </span><span>internal </span></code><hr/></div></div></li></ul></div></div></div>
